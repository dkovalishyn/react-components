<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>React components</title>
    <link rel="icon" href="./assets/react.jpg" type="image/jpg" />

    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/reveal.css" />
    <link rel="stylesheet" href="css/theme/black.css" />

    <!-- Theme used for syntax highlighting of code -->
    <link href="css/prism.css" rel="stylesheet" />

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement("link");
      link.rel = "stylesheet";
      link.type = "text/css";
      link.href = window.location.search.match(/print-pdf/gi)
        ? "css/print/pdf.css"
        : "css/print/paper.css";
      document.getElementsByTagName("head")[0].appendChild(link);
    </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">

        <section>
          <h1>React components</h1>
          <h3>Part 1</h3>
          <p>Denys Kovalishyn</p>
          <small>October, 2019</small>
        </section>

        <section>
          <p>
            <span>React</span> разделяет ответственность с помощью
            <span class="fragment highlight-red">слабо связанных единиц</span>,
            называемых «компоненты», которые содержат
            <span class="fragment highlight-red">и</span> разметку,
            <span class="fragment highlight-red">и</span> логику.
          </p>
        </section>

        <section>
          <h2>Виды компонентов</h2>
        </section>

        <!--Functional components-->
        <section>
          <section>
            <h3>Функциональные компоненты</h3>
          </section>
          <section>
            <h3>Синтаксис</h3>
            <pre><code data-trim class="language-jsx">
import React from 'react';
import logo from './logo.svg';
import './App.css';

const App = () => (
  &lt;div className="app"&gt;
    &lt;header className="app-header"&gt;
      &lt;img src={logo} className="app-logo" alt="logo"/&gt;
      &lt;p&gt;
        Edit &lt;code&gt;src/app.js&lt;/code&gt; and save to reload.
      &lt;/p&gt;
      &lt;a
		className="app-link"
		href="https://reactjs.org"
		target="_blank"
		rel="noopener noreferrer"
		&gt;
        Learn React
      &lt;/a&gt;
    &lt;/header&gt;
  &lt;/div&gt;
);

export default App;
        </code></pre>
          </section>
          <section>
            <p>Добавим еще одну ссылку:</p>
            <pre><code class="language-jsx">
&lt;div className="app"&gt;
	&lt;header className="app-header"&gt;
		&lt;img src={logo} className="app-logo" alt="logo"/&gt;
		&lt;p&gt;
			Edit &lt;code&gt;src/app.js&lt;/code&gt; and save to reload.
		&lt;/p&gt;
		&lt;nav&gt;
			&lt;a
				className="app-link"
				href="https://reactjs.org"
				target="_blank"
				rel="noopener noreferrer"
			&gt;
				Learn React
			&lt;/a&gt;
			&lt;a
				className="app-link"
				href="https://reacttraining.com"
				target="_blank"
				rel="noopener noreferrer"
			&gt;
				Learn react-router
			&lt;/a&gt;
		&lt;/nav&gt;
	&lt;/header&gt;
&lt;/div&gt;
				</code></pre>
          </section>
          <section>
            <h2>Композиция компонентов</h2>
            <p>
              React имеет мощную модель композиции, поэтому для повторного
              использования кода между компонентами мы рекомендуем использовать
              композицию вместо наследования.
            </p>
          </section>
          <section>
            <p>Создадим компонент Link</p>
            <pre><code class="language-jsx">
import React from "react";

const Link = props => (
  &lt;a
      className="app-link"
      href="https://reacttraining.com"
      target="_blank"
      rel="noopener noreferrer"
  &gt;
    Learn react-router
  &lt;/a&gt;
);

export default Link;
            </code></pre>
          </section>

          <section>
            <h3>Props</h3>
            <p>
              props (пропсы) — это входные данные React-компонентов,
              передаваемые от родительского компонента дочернему компоненту.
            </p>
            <p>
              Помните, props предназначены только для чтения. Ни в каком случае
              их не следует изменять.
            </p>
          </section>

          <section>
            <p>Сделаем наш компонент более универсальным:</p>
            <pre><code class="language-jsx">
import React from "react";

const Link = ({ to }) => (
  &lt;a
      className="app-link"
      href={to}
      target="_blank"
      rel="noopener noreferrer"
  &gt;
    Learn react-router
  &lt;/a&gt;
);

export default Link;
            </code></pre>
          </section>

          <section>
            <p>Выполним композицию компонентов:</p>
            <pre><code class="language-jsx">
import React from 'react';
import Link from './Link';
import logo from './logo.svg';
import './App.css';

const App = () => (
  &lt;div className="app"&gt;
    &lt;header className="app-header"&gt;
      &lt;img src={logo} className="app-logo" alt="logo"/&gt;
      &lt;p&gt;
        Edit &lt;code&gt;src/app.js&lt;/code&gt; and save to reload.
      &lt;/p&gt;
      &lt;nav&gt;
        &lt;Link to="https://reactjs.org"/&gt;
        &lt;Link to="https://reacttraining.com"/&gt;
      &lt;/nav&gt;
    &lt;/header&gt;
  &lt;/div&gt;
);

export default App;
            </code></pre>
          </section>

          <section>
            <h3>props.children</h3>
            <p>
              В любом компоненте доступны props.children. Это контент между
              открывающим и закрывающим тегом компонента.
            </p>
          </section>

          <section>
            <p>Используем props.children для изменения текста наших ссылок:</p>
            <pre><code class="language-jsx">
import React from "react";

const Link = ({ to, children }) => (
  &lt;a
      className="app-link"
      href={to}
      target="_blank"
      rel="noopener noreferrer"
  &gt;
    {children}
  &lt;/a&gt;
);

export default Link;
            </code></pre>
          </section>

          <section>
            <p>Поменяем текст наших ссылок</p>
            <pre><code class="language-jsx">
import React from 'react';
import Link from './Link';
import logo from './logo.svg';
import './App.css';

const App = () => (
  &lt;div className="app"&gt;
    &lt;header className="app-header"&gt;
      &lt;img src={logo} className="app-logo" alt="logo"/&gt;
      &lt;p&gt;
        Edit &lt;code&gt;src/app.js&lt;/code&gt; and save to reload.
      &lt;/p&gt;
      &lt;nav&gt;
        &lt;Link to="https://reactjs.org"&gt;Learn React&lt;/&gt;
        &lt;Link to="https://reacttraining.com"&gt;Learn React-Router&lt;/&gt;
      &lt;/nav&gt;
    &lt;/header&gt;
  &lt;/div&gt;
);

export default App;
            </code></pre>
          </section>

          <section>
            <h3>Проверка типов</h3>
            <p>
              По мере роста вашего приложения вы можете отловить много ошибок с
              помощью проверки типов. Для этого можно использовать расширения
              JavaScript вроде Flow и TypeScript.
            </p>
          </section>

          <section>
            <h3>Библиотека Prop-types</h3>
            <p>
              PropTypes предоставляет ряд валидаторов, которые могут
              использоваться для проверки, что получаемые данные корректны.
            </p>
          </section>

          <section>
            <p>Добавим проверку props в компоненте Link</p>
            <pre><code class="language-jsx">
import React from "react";
import PropTypes from "prop-types";
import "./styles.css";

const Link = ({ to, children }) => (
  &lt;a
    className="app-link"
    href={to} target="_blank"
    rel="noopener noreferrer
  "&gt;
    {children}
  &lt;/a&gt;
);

Link.propTypes = {
  to: PropTypes.string,
  children: PropTypes.node
};

Link.defaultProps = {
  to: "/",
  children: "Link"
};

export default Link;
            </code></pre>
          </section>

          <section>
            <h3>После компиляции</h3>
            <img src="assets/fc.png" alt="compiled functional components" />
          </section>

          <section>
            <h3>Выводы:</h3>
            <ul>
              <li>Меньше кода</li>
              <li>Легче читать и тестировать</li>
              <li>Работают быстрее</li>
            </ul>
          </section>
        </section>
        <!--End of functional components-->

        <!--Class components-->
        <section>
          <section>
            <h3>Классовые компоненты</h3>
          </section>

          <section>
            <h3>Синтаксис</h3>
            <pre><code data-trim class="language-js">
import React, { Component } from 'react';

export class StudentsList extends Component {
    render() {
        return &lt;div&gt;Students list&lt;/div&gt;
    }
}
            </code></pre>
          </section>

          <section>
            <p>Создадим форму:</p>
            <pre><code class="language-jsx">
import React, { Component } from "react";

class AddStudentForm extends Component {
  render() {
    return (
      &lt;form&gt;
        &lt;input type="text" defaultValue="Иван"/&gt;
        &lt;button&gt;Сохранить&lt;/button&gt;
      &lt;/form&gt;
    );
  }
}

export default AddStudentForm;
            </code></pre>
          </section>

          <section>
            <h3>Refs</h3>
            <p>
              Рефы дают возможность получить доступ к DOM-узлам или
              React-элементам, созданным в рендер-методе.
            </p>
          </section>

          <section>
            <h3>Когда использовать рефы</h3>
            <p>Ситуации, в которых использования рефов является оправданным:</p>
            <ul>
              <li class="fragment fade-up">
                Управление фокусом, выделение текста или воспроизведение медиа.
              </li>
              <li class="fragment fade-up">Императивный вызов анимаций.</li>
              <li class="fragment fade-up">
                Интеграция со сторонними DOM-библиотеками.
              </li>
            </ul>

            <p class="fragment fade-right">
              Избегайте использования рефов в ситуациях, когда задачу можно
              решить декларативным способом.
            </p>
          </section>

          <section>
            <p>Неконтролируемый компонент:</p>
            <pre><code class="language-jsx">
import React, { Component } from "react";

class AddStudentForm extends Component {
  inputRef = React.createRef();

  handleSubmit = () => alert(this.inputRef.current.value);

  render() {
    return (
      &lt;form onSubmit={this.handleSubmit}&gt;
        &lt;input
          ref={this.inputRef}
          type="text"
          defaultValue="Иван"
        /&gt;
        &lt;button&gt;Сохранить&lt;/button&gt;
      &lt;/form&gt;
    );
  }
}

export default AddStudentForm;
            </code></pre>
          </section>

          <section>
            <h3>state</h3>
            <p>
              State представляет собой механизм, который позволяет хранить
              данные, генерируемые компонентом, и синхронизировать отображение
              компонента с этими данными
            </p>
          </section>

          <section>
            <h3>props vs state</h3>
            <p class="fragment fade-right">
              Самая большая разница между state и props состоит в том, что props
              передаются от родителя потомку, а state управляется самим
              компонентом. Компонент не может изменять props, но может изменять
              state.
            </p>
            <p class="fragment fade-right">
              Для каждой отдельной части изменяемых данных должен существовать
              только один компонент, который «управляет» изменением состояния.
            </p>
          </section>

          <section>
            <h3>Нужен ли мне state?</h3>
            <p>
              Вам скорее всего не нужен state если:
            </p>
            <ul>
              <li class="fragment fade-up">
                Вы копируете в state какое-то значение из props.
              </li>
              <li class="fragment fade-up">
                Значение в state передается от родителей либо его можно каким-то
                образом вывести из props
              </li>
              <li class="fragment fade-up">Значение в state не меняется.</li>
            </ul>
          </section>

          <section>
            <h3>Контролируемый компонент:</h3>
            <pre><code class="language-jsx">
import React, { Component } from "react";

class AddStudentForm extends Component {
  constructor(props) {
    super(props);

    this.state = {
      name: "Иван"
    };
  }

  setName = ({ target: { value } }) =>
    this.setState({ name: value });

  handleSubmit = () => alert(this.state.name);

  render() {
    return (
      &lt;form onSubmit={this.handleSubmit}&gt;
        &lt;input
          type="text"
          onChange={this.setName}
          value={this.state.name}
        /&gt;
        &lt;button&gt;Сохранить&lt;/button&gt;
      &lt;/form&gt;
    );
  }
}

export default AddStudentForm;
            </code></pre>
          </section>

          <section>
            <p>setState</p>
            <pre><code class="language-js">setState(updater, [callback])</code></pre>
            <dl>
              <dt>updater</dt>
              <dd>
                это функция либо объект, которая определяет каким должно быть
                состояние компонента после рендеринга
              </dd>
              <dt>callback</dt>
              <dd>
                это функция, которая будет вызвана после обновления состояния
                компонента
              </dd>
            </dl>
          </section>

          <section>
            <p>updater</p>
            <pre><code class="language-js">(state, props) => stateChange</code></pre>
            <pre><code class="language-js">stateChange</code></pre>
            <dl>
              <dt>state</dt>
              <dd>текущее состояние компонента</dd>
              <dt>props</dt>
              <dd>текущие пропсы компонента</dd>
              <dt>stateChange</dt>
              <dd>ожидаемые изменения в состоянии</dd>
            </dl>
          </section>

          <section>
            <p>Добавим автоматическое сохранение в форму:</p>
            <pre><code class="language-jsx">
import React, { Component } from "react";

class AddStudentForm extends Component {
  constructor(props) {
    super(props);

    this.state = {
      name: 0,
      ...JSON.parse(localStorage.getItem(FORM_KEY)),
    };
  }

  componentDidUpdate(prevProps, prevState, snapshot) {
    this.saveTimer = setTimeout(this.serializeValues, 2000);
  }

  componentWillUnmount() {
    clearTimeout(this.saveTimer);
  }

  serializeValues = () => {
    localStorage.setItem(FORM_KEY, JSON.stringify(this.state));
    alert('Values saved!');
  };

  setName = ({ target: { value } }) => {
    this.setState({ name: value });
  };

  handleSubmit = () => alert(this.state.name);

  render() {
    return (
      &lt;form onSubmit={this.handleSubmit}&gt;
        &lt;input
          type="text"
          onChange={this.setName}
          value={this.state.name}
        /&gt;
        &lt;button&gt;Сохранить&lt;/button&gt;
      &lt;/form&gt;
    );
  }
}

export default AddStudentForm;
            </code></pre>
          </section>

          <section>
            <p>Методы жизненного цикла</p>
            <a
              href="http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/"
              >Диаграмма</a
            >
          </section>
          <section>
            <p>Fragment</p>
            <pre><code class="language-jsx">
 render() {
    return (
      &lt;React.Fragment&gt;
        &lt;Header /&gt;
          Students form:
          &lt;form onSubmit={this.handleSubmit}&gt;
          &lt;input
            type="text"
            onChange={this.setName}
            value={this.state.name}
          /&gt;
          &lt;button&gt;Сохранить&lt;/button&gt;
        &lt;/form&gt;
      &lt;/React.Fragment&gt;
    );
  }
            </code></pre>
          </section>
          <section>
            <p>Fragment without props</p>
            <pre><code class="language-jsx">
 render() {
    return (
      &lt;&gt;
        &lt;Header /&gt;
        Students form:
        &lt;form onSubmit={this.handleSubmit}&gt;
          &lt;input
            type="text"
            onChange={this.setName}
            value={this.state.name}
          /&gt;
          &lt;button&gt;Сохранить&lt;/button&gt;
        &lt;/form&gt;
      &lt;/&gt;
    );
  }
            </code></pre>
          </section>
        </section>
        <!--End of class components-->

        <!--Keys-->
        <section>
          <section>
            <h2>Key</h2>
            <p></p>
          </section>
        </section>
        <!--Portals-->

        <!--Keys-->
        <section>
          <section>
            <h2>Portals</h2>
            <p></p>
          </section>
          <section></section>
        </section>
        <!--End of keys-->

        <!--Styles-->
        <section>
          <section><h2>Styles</h2></section>
          <section><h3>CSS</h3></section>
          <section><h3>CSS modules</h3></section>
          <section><h3>Inline styles</h3></section>
          <section><h3>Styled components</h3></section>
        </section>
        <!--End of styles-->

        <!--Error boundary-->
        <section>
          <h3>Error boundary</h3>
          <a href="https://codepen.io/gaearon/pen/wqvxGa?editors=0010">
            Example by Dan Abramov
          </a>
        </section>
        <!--End of error boundary-->

        <!--HOC-->
        <!--End of HOC-->

        <!--Render Prop-->
        <section>
          <section>
            <p>Render prop - </p>
          </section>
        </section>
        <!--end of render prop-->

        <!--HomeWork-->
        <section>
          <h2>Домашнее задание</h2>
          <section></section>
        </section>
        <!--End of homework-->
      </div>
    </div>

    <script src="js/reveal.js"></script>

    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
        dependencies: [
          { src: "plugin/markdown/marked.js" },
          { src: "plugin/markdown/markdown.js" },
          { src: "plugin/notes/notes.js", async: true }
        ]
      });
    </script>
    <script src="js/prism.js"></script>
  </body>
</html>
